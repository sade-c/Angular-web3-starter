"use strict";(self.webpackChunkAngweb3=self.webpackChunkAngweb3||[]).push([[592],{6897:(m,b,i)=>{i.d(b,{V:()=>C});var c=i(5861),E=i(8538),y=i.n(E),_=i(9751),A=i(1135),w=i(4315);class C{constructor(t,e,n){this._messageService=t,this._web3Service=e,this._eventListeners={},console.log("addres for usdc 1",n),this.address=n,this._web3Service.getUserAccountAddressSubject().subscribe(s=>{this._fromAccount=s})}getContract(t){var e=this;return(0,c.Z)(function*(){if(console.log("addres for usdc 11",e.address),null!=e.contract)return e.contract;if(e._web3Service){const n=yield e._web3Service.getContract(t,e.address);if(null==n)throw new Error("Contract not found. Confirm that your wallet is connected on the right chain");return n}throw new Error("Web3 not instanciated")})()}owner(){return new _.y(t=>{this._owner?t.next(this._owner):this.getString(this.getContractABI(),"owner").then(e=>{this._owner=e,t.next(this._owner)})})}isOwner(){return new _.y(t=>{this.owner().subscribe(e=>{this._web3Service.getUserAccountAddressSubject().subscribe(n=>{t.next(e===n)})})})}getEventBehaviorSubject(t){var e=this;return(0,c.Z)(function*(){const n=yield e.getContract(e.getContractABI()),s=e._validateEventAndInstanceSubject(n,t.eventName,t.web3jsParameters),r=s.key;if(s.new){let u;t.web3jsParameters&&(u={filter:t.web3jsParameters}),n.events[t.eventName](u).on("data",a=>{e._eventListeners[r]&&e._eventListeners[r].next(a.returnValues)}).on("error",a=>{console.error(t.eventName,a)})}return e._eventListeners[r]})()}getWeb3EventSubscription(t){var e=this;return(0,c.Z)(function*(){return(yield e.getContract(e.getContractABI())).events[t.eventName](t)})()}allWeb3Events(){var t=this;return(0,c.Z)(function*(){return(yield t.getContract(t.getContractABI())).getPastEvents("allEvents")})()}getWeb3PastEventSubscription(t){var e=this;return(0,c.Z)(function*(){return(yield e.getContract(e.getContractABI())).getPastEvents(t.eventName,t.web3jsParameters)})()}_validateEventAndInstanceSubject(t,e,n){if(t.events[e]){let s=!1;const r=n?e.concat(JSON.stringify(n)):e;return this._eventListeners[r]||(this._eventListeners[r]=new A.X(null),s=!0),{new:s,key:r}}throw new Error(`Event '${e}' does not exists in the contract`)}call(t,e,...n){return this.callPrivate(t,e,this.justReturnV,...n)}callBN(t,e,...n){return this.callPrivate(t,e,s=>new(y())(s),...n)}send(t,e,n,s,r,...u){return new _.y(l=>{this.getContract(t).then(a=>{let d;this._web3Service.getUserAccountAddressSubject().subscribe(function(){var g=(0,c.Z)(function*(h){try{d=yield a.methods[e](...u).send({from:h}).on("transactionHash",o=>{l.next({success:!0,result:n})}).once("confirmation",(o,v,f)=>{s&&s({success:!0,result:r||""})})}catch(o){const v=w.M[o.code];console.log(o.message);let f="We had some problem. The transaction wasn't sent.";v&&(f=`${v.title}: ${v.message}. The transaction wasn't sent.`),console.warn(o),s?s({success:!1,result:f}):l.next({success:!1,result:f})}});return function(h){return g.apply(this,arguments)}}())})})}getString(t,e){return this.getProperty(t,e)}getStringArray(t,e){return this.getProperty(t,e)}getBoolean(t,e){var n=this;return(0,c.Z)(function*(){return n.getProperty(t,e)})()}getNumber(t,e){return this.getProperty(t,e)}getBN(t,e){return this.getProperty(t,e)}getProperty(t,e){var n=this;return(0,c.Z)(function*(){try{return yield(yield n.getContract(t)).methods[e]().call({from:n._fromAccount})}catch(s){console.error(s),n._messageService.showMessageAlert("Error",`Unexpected exception when fetching '${e}': ${s.message}`)}})()}justReturnV(t){return t}callPrivate(t,e,n=this.justReturnV,...s){return new _.y(r=>{this.getContract(t).then(u=>{let l;this._web3Service.getUserAccountAddressSubject().subscribe(function(){var a=(0,c.Z)(function*(d){try{l=yield u.methods[e](...s).call({from:d}),r.next({success:!0,result:n(l)})}catch(g){const h=w.M[g.code];let o="We had some problem. The transaction wasn't sent.";h&&(o=`${h.title}: ${h.message}. The transaction wasn't sent.`),console.warn(g),r.next({success:!1,result:o})}});return function(d){return a.apply(this,arguments)}}())})})}}}}]);